(function(){"use strict";self.addEventListener("message",async({data:s})=>{const{handle:e,dir:a,includeFileContent:i,ignoredDirectories:l,filesToIndex:o}=s,t=await f(e,a,i,l,o);t.indexed=!0,postMessage(t)});const f=async(s,e={},a=!1,i=[],l=[])=>{for await(const[o,t]of s.entries()){const n=e.path+"/"+o;if(t.kind==="file"){if(e.entries[n]={path:n,handle:t,parentHandle:s},a){const r=n.split("/").pop().split(".").pop(),p=l.includes(r),c=p?await t.getFile():null;e.entries[n].fileContent=p?await(c==null?void 0:c.text()):""}}else e.entries[n]={path:n,handle:t,parentHandle:s,entries:{}},i.includes(o)||await f(t,e.entries[n],a,i,l)}return e.hasFileContent=a,e}})();
